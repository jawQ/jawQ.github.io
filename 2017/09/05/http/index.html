<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="你了解你的HTTP请求有多辛苦吗？？？"><meta name="keywords" content="HTTP"><meta name="author" content="JawQ_,undefined"><meta name="copyright" content="JawQ_"><title>你了解你的HTTP请求有多辛苦吗？？？ | JawQ_</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.4.3"><script>var GLOBAL = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP请求与响应"><span class="toc-number">1.</span> <span class="toc-text">HTTP请求与响应</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#前言："><span class="toc-number"></span> <span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有错误的可以通过下面二维码的联系方式联系我，欢迎指点错误。"><span class="toc-number"></span> <span class="toc-text">有错误的可以通过下面二维码的联系方式联系我，欢迎指点错误。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#背景"><span class="toc-number"></span> <span class="toc-text">背景:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-IP参考模型"><span class="toc-number"></span> <span class="toc-text">TCP/IP参考模型:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#目录："><span class="toc-number"></span> <span class="toc-text">目录：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP请求"><span class="toc-number"></span> <span class="toc-text">HTTP请求:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-应用层"><span class="toc-number">1.</span> <span class="toc-text">1. 应用层:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-传输层"><span class="toc-number">2.</span> <span class="toc-text">2. 传输层:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-网络层（IP层）："><span class="toc-number">3.</span> <span class="toc-text">3. 网络层（IP层）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-链路层"><span class="toc-number">4.</span> <span class="toc-text">4. 链路层:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP响应"><span class="toc-number"></span> <span class="toc-text">HTTP响应:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#疑惑点："><span class="toc-number">1.</span> <span class="toc-text">疑惑点：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IP和MAC区别"><span class="toc-number">1.1.</span> <span class="toc-text">IP和MAC区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#到这-你可能会有这样的疑问"><span class="toc-number">1.2.</span> <span class="toc-text">*到这,你可能会有这样的疑问?**</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#那为什么路由就能知道，接收到的报文要发往哪里呢？"><span class="toc-number">1.3.</span> <span class="toc-text">那为什么路由就能知道，接收到的报文要发往哪里呢？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TCP协议-三次握手"><span class="toc-number">1.4.</span> <span class="toc-text">TCP协议-三次握手</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#你可能会有疑问：为什么是3次握手？"><span class="toc-number">1.4.1.</span> <span class="toc-text">你可能会有疑问：为什么是3次握手？</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结："><span class="toc-number"></span> <span class="toc-text">总结：</span></a></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/JawQ.png"></div><div class="author-info__name text-center">JawQ_</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">7</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">14</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">关于JawQ：</div><a class="author-info-links__name text-center" href="https://juejin.im/user/58b39f0e2f301e00680d71f0" target="_blank">掘金</a><a class="author-info-links__name text-center" href="https://www.zhihu.com/people/JawQ/activities" target="_blank">知乎</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://drscdn.500px.org/photo/241217445/q%3D80_m%3D2000_k%3D1/v2?webp=true&amp;sig=20a0a057e571acfe0fd27f642b6908c963c15ddb841447bd91d890b5647eacb1)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">JawQ_</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/Tags">Tags</a></span></div><div id="post-info"><div id="post-title">你了解你的HTTP请求有多辛苦吗？？？</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-05-13</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2,696</span><span class="post-meta__separator">|</span><span>阅读时长: 8 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h3 id="HTTP请求与响应"><a href="#HTTP请求与响应" class="headerlink" title="HTTP请求与响应"></a>HTTP请求与响应</h3><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>作为一名合格的前端,每天会应对无数的网络请求。<br>所以，了解这些网络底层是怎么从源发送过来的，接收源的又是如何处理的，对你的工作中的调试是有质的提升的。<br><a id="more"></a><br>刚好最近希望系统的学习下，就选择了工作中较常见的HTTP请求与响应。</p>
<h2 id="有错误的可以通过下面二维码的联系方式联系我，欢迎指点错误。"><a href="#有错误的可以通过下面二维码的联系方式联系我，欢迎指点错误。" class="headerlink" title="有错误的可以通过下面二维码的联系方式联系我，欢迎指点错误。"></a>有错误的可以通过下面二维码的联系方式联系我，欢迎指点错误。</h2><h2 id="背景"><a href="#背景" class="headerlink" title="背景:"></a>背景:</h2><p>互联网上相关联的协议，集合起来可以有个叫法叫“TCP/IP协议族”。</p>
<p>我们只要了解其中的HTTP协议，就够用了。<br>那这个协议族里有个比较重要的点，就是分层。<br>从上往下分呢，分别是应用层，传输层，网络层和网络数据链路层。<br>等等阅读时可以参考”TCP/IP参考模型”图来理解。</p>
<hr>
<h2 id="TCP-IP参考模型"><a href="#TCP-IP参考模型" class="headerlink" title="TCP/IP参考模型:"></a>TCP/IP参考模型:</h2><p><img src="https://wx.smallapp.wangten.com/public/TCPIP.jpg" alt="TCP/IP结构模型"></p>
<hr>
<h2 id="目录："><a href="#目录：" class="headerlink" title="目录："></a>目录：</h2><blockquote>
<ul>
<li>应用层</li>
<li>传输层</li>
<li>网络层</li>
<li>链路层</li>
</ul>
</blockquote>
<hr>
<h2 id="HTTP请求"><a href="#HTTP请求" class="headerlink" title="HTTP请求:"></a>HTTP请求:</h2><h3 id="1-应用层"><a href="#1-应用层" class="headerlink" title="1. 应用层:"></a>1. 应用层:</h3><p>该层里包含很多常见的协议，如ftp协议，smtp协议，还有本篇主角HTTP协议。</p>
<p>当一个HTTP请求被发出时，通常是由发送方（客户端）发起，那么此时是到达了”TCP/IP参考模型”中的应用层的。<br>其中起作用的是HTTP协议，该协议生成了针对目标（也就是接收方服务器）的HTTP请求报文（包含了请求行，请求头部，有时还带有请求体，具体见下一篇详细的解释），并发往下一层。<br>注意，这时候的报文还是完整的。</p>
<p><strong>小结： 应用层是用来生成报文的。</strong></p>
<p><span id="translate"></span></p>
<h3 id="2-传输层"><a href="#2-传输层" class="headerlink" title="2. 传输层:"></a>2. 传输层:</h3><p>当HTTP请求穿过应用层后，就是到达了传输层了。该层内主要作用是传输报文，只不过这里的报文被做了些手脚。</p>
<p>其中，为了传输方便，TCP协议将一串串完整的请求报文，按序号分割成多个报文段，并在各个报文上打上标记序号以及端口号,形成IP数据包，最后再将一个个<strong>被切割后的报文片段</strong>传输给网络层。<br>注意，这时候是片段了。</p>
<p><strong>小结： 传输层是用来切割报文的。</strong></p>
<p><span id="internet"></span></p>
<h3 id="3-网络层（IP层）："><a href="#3-网络层（IP层）：" class="headerlink" title="3. 网络层（IP层）："></a>3. 网络层（IP层）：</h3><p>这里的网络，并不是我们平时理解的网络信号的网络，这里指的是一种结构模型层。<br><a href="#IpAndMac">首先，先来了解下IP和MAC区别</a></p>
<p>好，当到达网络层后，这时候才是整个“TCP/IP参考模型”结构体系的关键，因为它<strong>决定了发往哪里去，按什么顺序发</strong>。</p>
<p>其底层使用的就是因特网协议，也就是IP协议(如果你想联网)。<br>它将客户端和服务器端这两端通过<strong>路由</strong>作为桥梁，IP协议作为通信工具，连接起来进行通信。</p>
<p>其中，路由的作用就是：为接收到的处理好的请求报文(也就是数据包)找到相对应的<strong>目的主机</strong>（接收方）。<a href="#FindRouter">点我去看路由找地址的原理</a></p>
<p>还有，路由主要使用的协议即为IP协议。所以，网络层也有别的叫法，就是IP层。</p>
<p>那在与目标服务器连接之前呢，还会干这样的事…<br>会发生握手事件，<strong>TCP协议著名的三次握手，就在该层发生的。<a href="#TCP-ThreeHandshakes">点我去看TCP三次握手的简单过程。</a></strong></p>
<p><strong>小结：网络层可以看成是个指路牌，即根据报文在路由表里寻找目标服务器的地址。</strong></p>
<h3 id="4-链路层"><a href="#4-链路层" class="headerlink" title="4. 链路层:"></a>4. 链路层:</h3><p>该层可以说是和设备最近的一个层级，也就是物理层（OSI模型）最接近的一层了。<br>那么就是说，离服务器接口最近了。</p>
<p>但是呢，该层是不干活的，为什么呢？你有见过领导还写业务代码吗？</p>
<p>当然，也不是啥都没干。<br>链路层作用中的其中作用之一就是在检测你这些处理完过来的报文数据到底有没错误。也就是测试。<br>测试什么呢？<br>具体我也不知道怎么检测，但我给出自己的猜测，希望有懂的大牛能告知我一声，感谢。<br>我认为的是链路层要做的事是，就是确定是否存在该物理地址，以及确定目的地址是否存在等问题。<br>balabala…<br>当确认无误后呢，就交给服务器处理了。<br>服务器对得到的报文进行解析处理，然后返回带有响应数据的响应，于是，响应就开始了。<br><strong>小结： 链路层是用来检测、确认报文数据，然后就是作为接口，对接服务器或硬件的。</strong></p>
<hr>
<h2 id="HTTP响应"><a href="#HTTP响应" class="headerlink" title="HTTP响应:"></a>HTTP响应:</h2><p>具体过程就相当于刚刚来的路，重走一次，只不过这次是倒着走了。</p>
<p>链路层 –&gt; 网络层 –&gt; 传输层 –&gt; 应用层 —&gt; 客户端，通常是浏览器，就这样，一次请求和响应就完成了。</p>
<hr>
<h3 id="疑惑点："><a href="#疑惑点：" class="headerlink" title="疑惑点："></a>疑惑点：</h3><p><span id="IpAndMac"></span></p>
<h4 id="IP和MAC区别"><a href="#IP和MAC区别" class="headerlink" title="IP和MAC区别"></a>IP和MAC区别</h4><blockquote>
<ul>
<li>首先，要先解释下其中两个难点区分，就是IP地址和MAC地址。</li>
<li>IP地址是Internet协议地址,是逻辑地址,也就是抽象的，是每个Internet包给的，动态的，可以不同的。</li>
<li>而MAC地址却是物理地址,也就是实际存在的,由设备的网卡提供的,而且一般不能改变的，也就是固定的了。</li>
<li>通俗地讲，IP地址可以理解为你家门牌号，而MAC地址相当于你个人身份证。</li>
<li>两者并没有必然关系。</li>
</ul>
</blockquote>
<p><a href="#internet">看完了回去继续看网络层</a></p>
<p><span id="ChooseIpOrMac"></span></p>
<h4 id="到这-你可能会有这样的疑问"><a href="#到这-你可能会有这样的疑问" class="headerlink" title="*到这,你可能会有这样的疑问?**"></a>*到这,你可能会有这样的疑问?**</h4><p><strong>既然有了IP地址能定位,那为什么还要MAC地址呢?</strong></p>
<blockquote>
<p>这里借助知乎一个回答:</p>
</blockquote>
<p>由于IP地址是在第三层—网络层中被定义的，具有第三层的意义；<br>而MAC地址在第二层中定义，具备第二层的意义。<br>所以，在同一网段内，即局域网内，只需要使用MAC地址就能够定位你是哪台主机了；<br>但是，一旦跨了网段（即互联网环境），此时单独靠MAC地址来定位，不仅吃力，还有可能找不到，因为有可能会有一样的MAC地址出现。所以需要IP地址来寻址。<br>那IP地址是做什么呢?IP地址主要是用于网络定位,用于互联网,由于MAC地址受硬件限制,因此IP地址用于互联网的定位更有先天优势。</p>
<p><span id="FindRouter"></span></p>
<h4 id="那为什么路由就能知道，接收到的报文要发往哪里呢？"><a href="#那为什么路由就能知道，接收到的报文要发往哪里呢？" class="headerlink" title="那为什么路由就能知道，接收到的报文要发往哪里呢？"></a><strong>那为什么路由就能知道，接收到的报文要发往哪里呢？</strong></h4><p>原来，该报文里就包含了目标主机的IP地址。<br>而IP地址含有两个部分，一个是网络地址，一个是主机地址。<br>而且，通过对方的IP地址，不仅可以判断出对方是否和本机在一个网络内，还能获取对方主机地址。</p>
<p>那么，路由的处理机制分<strong>两种情况</strong>，</p>
<ul>
<li><strong><em>第一</em></strong>，针对不需要跨网段的，也就是在局域网内：<br>这时候交给”交换机”处理。</li>
</ul>
<p>这，就体现了mac地址的作用了,因为mac地址是物理地址，硬件地址，由网卡提供的，一般无法改变。</p>
<p>而网络层中路由借助“ARP协议”，会将目标主机（目标服务器）的IP地址,解析成目标主机对应的MAC地址与arp表对应，然后，告诉交换机，然后交换机会根据自己的转发表中的mac地址和mac地址对应的端口号一一对应,然后进行转发。</p>
<p>如果在转发表内找到了对应端口号，那么恭喜，你的快递是顺丰的，交换机直接一步到位发送到目标主机；如果找不到，呵呵，你估计贪便宜，找了韵达了…它就每个端口都转发一次，总会中一次的，很粗暴的方法，自然效率偏低了。</p>
<ul>
<li><strong><em>第二</em></strong>，针对需要跨网段，也就是进入因特网了：<br>这时候交给网关处理。</li>
</ul>
<p>这时候就需要使用请求报文中的IP地址，来寻找目标主机的IP位置，接着告诉网关IP地址，网关进行匹配相应的路由，然后在路由表中寻找对应的IP地址，然后根据IP地址中的网络地址，判断是跨网还是内网，再决定要往哪个网络跳转。</p>
<p><a href="#internet">看完了回去继续看网络层-路由</a></p>
<p><span id="TCP-ThreeHandshakes"></span></p>
<h4 id="TCP协议-三次握手"><a href="#TCP协议-三次握手" class="headerlink" title="TCP协议-三次握手"></a><strong>TCP协议-三次握手</strong></h4><p><strong>首先</strong>，先<strong>一笔带过</strong>这三次，握的是什么手。是猪手还是咸猪手？</p>
<ul>
<li>第一次：客户端发出SYN连接请求，告诉服务器，我要来了；</li>
<li>第二次：服务器收到SYN，然后向客户端发出既有SYN，也有ACK的连接请求；</li>
<li>第三次：客户端收到了服务器发来的带2个属性的请求，最后发出一个确认报文ACK的请求告诉服务器。</li>
</ul>
<h5 id="你可能会有疑问：为什么是3次握手？"><a href="#你可能会有疑问：为什么是3次握手？" class="headerlink" title="你可能会有疑问：为什么是3次握手？"></a>你可能会有疑问：为什么是3次握手？</h5><p>其实第2次应该就可以开始连接了吧。关于这点，要从谁是发起方说起。<br>由于现在发起方是客户端，所以从客户端说起。</p>
<p>想象下这样一个情景：<br>客户端发送了请求，如果想知道有没发送成功，得靠响应吧。<br>所以服务器返回了一个响应，告诉客户端，服务器已经收到你的请求了。<br><strong>但站在服务器的角度来看，服务器本身并不知道客户端有没收到自己发送给它的响应啊。</strong><br>于是，客户端，最后再次发送一段报文给服务端，告诉他：”我已经收到你的请求了，我准备好了，我们可以开始连接了，你也准备好吧。“</p>
<p><strong>所以才有第三次握手的需要。</strong></p>
<p>至于这3次握手里，究竟具体是怎么实现的，我也会弄明白的，所以以后会上的。</p>
<p><a href="#internet">看完了回去继续看网络层</a></p>
<hr>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><blockquote>
<p>一次完整的HTTP请求,从发送到接收,是需要经历: 应用层–&gt;传输层–&gt;网络层–&gt;链路层，甚至到了物理层的。</p>
</blockquote>
<hr>
<p>下一篇，我会对一次HTTP请求中的报文进行详细解释，也就是说如果你想知道HTTP请求中带了哪些东西，可以看看我下一篇文章。</p>
<hr>
<p>个人能力有限，有错误的麻烦扫描下面二维码联系我（回复公众号我就能收到），进行勘误，共同进步。</p>
<p><img src="https://wx.smallapp.wangten.com/public/JawQpublic.jpg" alt="个人公众号二维码"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">JawQ_</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://wujiaqiang.com/2017/09/05/http/">http://wujiaqiang.com/2017/09/05/http/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明来自 <a href="http://wujiaqiang.com" target="_blank">JawQ_</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/HTTP/">HTTP</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://wx.smallapp.wangten.com/public/alipay.jpg"><div class="post-qr-code__desc">支付宝-打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://wx.smallapp.wangten.com/public/wechat.jpg"><div class="post-qr-code__desc">微信-打赏</div></div></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2017/11/09/JSONP/"><i class="fa fa-chevron-left">  </i><span>吹吹 JSONP</span></a></div><div class="next-post pull-right"><a href="/2017/08/28/configHttps/"><span>从http到https</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2018 By JawQ_</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.4.3"></script><script src="/js/fancybox.js?version=1.4.3"></script><script src="/js/sidebar.js?version=1.4.3"></script><script src="/js/copy.js?version=1.4.3"></script><script src="/js/fireworks.js?version=1.4.3"></script><script src="/js/transition.js?version=1.4.3"></script><script src="/js/scroll.js?version=1.4.3"></script><script src="/js/head.js?version=1.4.3"></script></body></html>